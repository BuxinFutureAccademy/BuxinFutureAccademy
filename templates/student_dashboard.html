{% extends "base.html" %}

{% block navbar %}
<!-- Simplified Navigation for Student Dashboard - Logo + Sign Out Only -->
<nav class="navbar navbar-expand-lg navbar-light">
    <div class="container">
        <a class="navbar-brand" href="javascript:void(0);" onclick="window.location.reload(); return false;">
            <img src="https://res.cloudinary.com/dfizb64hx/image/upload/v1753480189/Untvvvvitled-1_i2iduk.png" alt="Logo" width="30" height="30" class="d-inline-block align-text-top me-2">
            BuXin Academy
        </a>
        
        <div class="ms-auto">
            {% if current_user.is_authenticated %}
                <a class="nav-link d-inline-block" href="{{ url_for('auth.logout') }}">
                    <i class="fas fa-sign-out-alt me-1"></i>Sign Out
                </a>
            {% endif %}
        </div>
    </div>
</nav>
{% endblock %}

{% block content %}
<style>
    :root {
        --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --warning-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        --robotics-primary: #00d4ff;
        --robotics-secondary: #ff6b35;
        --robotics-accent: #39ff14;
        --robotics-dark: #0a0a1a;
        --robotics-darker: #050510;
        --robotics-gradient: linear-gradient(135deg, #00d4ff 0%, #0099cc 50%, #006699 100%);
        --robotics-neon: linear-gradient(135deg, #39ff14 0%, #00d4ff 100%);
        --surface: rgba(255, 255, 255, 0.05);
        --surface-solid: rgba(5, 5, 16, 0.9);
        --background: var(--robotics-darker);
        --on-surface: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.7);
        --border: rgba(0, 212, 255, 0.3);
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
        --shadow-lg: 0 20px 25px -5px rgba(0, 212, 255, 0.2), 0 10px 10px -5px rgba(0, 212, 255, 0.1);
        --shadow-neon: 0 0 30px rgba(0, 212, 255, 0.3);
        --radius: 16px;
        --radius-sm: 8px;
        --font-tech: 'Orbitron', sans-serif;
        --font-body: 'Rajdhani', sans-serif;
    }

    body {
        background: var(--background);
        background-image: 
            radial-gradient(circle at 20% 50%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 30%, rgba(255, 107, 53, 0.1) 0%, transparent 50%),
            linear-gradient(rgba(0, 212, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 212, 255, 0.03) 1px, transparent 1px);
        background-size: 100% 100%, 100% 100%, 50px 50px, 50px 50px;
        font-family: var(--font-body);
        color: var(--on-surface);
        min-height: 100vh;
    }

    /* Modern Header */
    .classroom-header {
        background: var(--surface-solid);
        border-bottom: 2px solid var(--border);
        padding: 2rem 0;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
    }

    .classroom-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--robotics-gradient);
        opacity: 0.1;
    }

    .welcome-section {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 1rem;
        position: relative;
        z-index: 2;
    }

    .welcome-content h1 {
        font-family: var(--font-tech);
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--on-surface);
        margin: 0;
        background: var(--robotics-neon);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .welcome-subtitle {
        color: var(--text-secondary);
        margin: 0.5rem 0 0 0;
        font-size: 1.1rem;
        font-family: var(--font-body);
    }

    .quick-stats {
        display: flex;
        gap: 1.5rem;
        align-items: center;
    }

    .stat-card {
        background: var(--surface-solid);
        padding: 1rem 1.5rem;
        border-radius: var(--radius-sm);
        border: 1px solid var(--border);
        text-align: center;
        min-width: 100px;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-neon);
        border-color: var(--robotics-primary);
    }

    .stat-number {
        font-family: var(--font-tech);
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--robotics-neon);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .stat-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        margin-top: 0.25rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* Main Layout */
    .classroom-container {
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
    }

    /* Quick Actions Sidebar */
    .quick-actions {
        background: var(--surface-solid);
        border-radius: var(--radius);
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        height: fit-content;
        position: sticky;
        top: 2rem;
        backdrop-filter: blur(10px);
    }

    .section-title {
        font-family: var(--font-tech);
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--robotics-primary);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .action-btn {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        width: 100%;
        padding: 1rem;
        margin-bottom: 0.75rem;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        color: var(--on-surface);
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        font-family: var(--font-body);
    }

    .action-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: var(--robotics-gradient);
        transition: left 0.3s ease;
        z-index: 0;
    }

    .action-btn:hover::before {
        left: 0;
    }

    .action-btn:hover {
        color: var(--robotics-dark);
        border-color: var(--robotics-primary);
        transform: translateY(-2px);
        box-shadow: var(--shadow-neon);
    }

    .action-btn i,
    .action-btn span {
        position: relative;
        z-index: 1;
    }

    .action-btn .badge {
        margin-left: auto;
        position: relative;
        z-index: 1;
    }

    /* Main Content Area */
    .main-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    /* Attendance Section */
    .attendance-section {
        background: var(--surface-solid);
        border-radius: var(--radius);
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        backdrop-filter: blur(10px);
    }

    .attendance-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        padding: 1.5rem;
        margin-bottom: 1rem;
    }

    .attendance-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .student-name {
        font-family: var(--font-tech);
        font-size: 1.2rem;
        color: var(--robotics-primary);
        text-transform: uppercase;
    }

    .attendance-badge {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .badge-present {
        background: rgba(57, 255, 20, 0.2);
        color: var(--robotics-accent);
        border: 1px solid var(--robotics-accent);
    }

    .badge-absent {
        background: rgba(255, 107, 53, 0.2);
        color: var(--robotics-secondary);
        border: 1px solid var(--robotics-secondary);
    }

    .badge-not-marked {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-secondary);
        border: 1px solid var(--border);
    }

    /* Live Class Pulse Animation */
    @keyframes pulse {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.5;
        }
    }

    .attendance-btn {
        padding: 0.8rem 1.5rem;
        border: none;
        border-radius: 10px;
        font-family: var(--font-tech);
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-right: 0.5rem;
    }

    .btn-present {
        background: var(--robotics-neon);
        color: var(--robotics-dark);
    }

    .btn-present:hover {
        box-shadow: var(--shadow-neon);
        transform: scale(1.05);
    }

    .btn-absent {
        background: var(--danger-gradient);
        color: white;
    }

    .progress-bar-container {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        height: 30px;
        overflow: hidden;
        margin-top: 0.5rem;
        position: relative;
    }

    .progress-bar {
        height: 100%;
        background: var(--robotics-neon);
        transition: width 1s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.85rem;
        color: var(--robotics-dark);
    }

    /* Learning Materials Feed */
    .materials-feed {
        background: var(--surface-solid);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        overflow: hidden;
        backdrop-filter: blur(10px);
    }

    .feed-header {
        background: var(--robotics-gradient);
        color: white;
        padding: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .feed-controls {
        display: flex;
        gap: 0.5rem;
    }

    .feed-btn {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: var(--font-body);
    }

    .feed-btn:hover,
    .feed-btn.active {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.05);
    }

    .materials-container {
        max-height: 600px;
        overflow-y: auto;
        padding: 0;
    }

    .material-item {
        border-bottom: 1px solid var(--border);
        padding: 1.5rem;
        transition: all 0.3s ease;
        position: relative;
        background: var(--surface);
    }

    .material-item:hover {
        background: rgba(0, 212, 255, 0.05);
    }

    .material-item:last-child {
        border-bottom: none;
    }

    .material-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
    }

    .class-badge {
        background: var(--robotics-gradient);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-family: var(--font-tech);
    }

    .material-time {
        color: var(--text-secondary);
        font-size: 0.875rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .material-content {
        color: var(--on-surface);
        line-height: 1.6;
        margin-bottom: 1rem;
        cursor: pointer;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 1rem;
        transition: all 0.2s;
        position: relative;
        word-break: break-word;
    }

    .material-content.expanded {
        background: rgba(57, 255, 20, 0.1);
        border: 1px solid var(--robotics-accent);
    }

    .material-actions {
        display: flex;
        gap: 0.75rem;
        align-items: center;
        flex-wrap: wrap;
    }

    .material-action {
        background: var(--surface);
        border: 1px solid var(--border);
        color: var(--text-secondary);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-family: var(--font-body);
    }

    .material-action:hover {
        background: var(--robotics-gradient);
        color: white;
        border-color: var(--robotics-primary);
    }

    /* Tools Sidebar */
    .tools-sidebar {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .tool-widget {
        background: var(--surface-solid);
        border-radius: var(--radius);
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        position: sticky;
        top: 2rem;
        backdrop-filter: blur(10px);
    }

    /* Clock Widget */
    .clock-widget {
        text-align: center;
        background: var(--robotics-gradient);
        color: white;
    }

    .current-time {
        font-family: var(--font-tech);
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .current-date {
        font-size: 1rem;
        opacity: 0.9;
    }

    /* Calendar Widget */
    .calendar-widget {
        background: var(--success-gradient);
        color: white;
    }

    .calendar-header {
        text-align: center;
        margin-bottom: 1rem;
        font-weight: 600;
        font-family: var(--font-tech);
    }

    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 0.25rem;
        font-size: 0.875rem;
    }

    .calendar-day {
        aspect-ratio: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .calendar-day:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    .calendar-day.today {
        background: rgba(255, 255, 255, 0.3);
        font-weight: 700;
    }

    /* Notes Widget */
    .notes-widget textarea {
        width: 100%;
        min-height: 120px;
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        padding: 1rem;
        font-family: var(--font-body);
        resize: vertical;
        transition: all 0.3s ease;
        background: var(--surface);
        color: var(--on-surface);
    }

    .notes-widget textarea:focus {
        outline: none;
        border-color: var(--robotics-primary);
        box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
    }

    /* Progress Widget */
    .progress-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .progress-label {
        font-size: 0.875rem;
        color: var(--on-surface);
        font-weight: 500;
    }

    .progress-bar-container {
        width: 100%;
        height: 8px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 4px;
        overflow: hidden;
        margin: 0.5rem 0;
    }

    .progress-fill {
        height: 100%;
        background: var(--robotics-neon);
        border-radius: 4px;
        transition: width 0.6s ease;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--text-secondary);
    }

    .empty-state i {
        font-size: 4rem;
        margin-bottom: 1.5rem;
        opacity: 0.5;
        background: var(--robotics-neon);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    /* Custom Scrollbar */
    .materials-container::-webkit-scrollbar {
        width: 8px;
    }

    .materials-container::-webkit-scrollbar-track {
        background: var(--surface);
    }

    .materials-container::-webkit-scrollbar-thumb {
        background: var(--robotics-gradient);
        border-radius: 4px;
    }

    .materials-container::-webkit-scrollbar-thumb:hover {
        background: var(--robotics-primary);
    }

    /* Class Cards */
    .class-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        padding: 1.5rem;
        margin-bottom: 1rem;
        transition: all 0.3s ease;
    }

    .class-card:hover {
        border-color: var(--robotics-primary);
        box-shadow: var(--shadow-neon);
        transform: translateX(5px);
    }

    .class-name {
        font-family: var(--font-tech);
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--robotics-primary);
        text-transform: uppercase;
        margin-bottom: 0.5rem;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
        .classroom-container {
            grid-template-columns: 1fr 2fr;
        }
        
        .tools-sidebar {
            grid-column: 1 / -1;
            grid-row: 3;
            flex-direction: row;
            overflow-x: auto;
        }
        
        .tool-widget {
            min-width: 280px;
            position: static;
        }
    }

    @media (max-width: 768px) {
        .classroom-container {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .welcome-section {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .quick-stats {
            width: 100%;
            justify-content: space-between;
        }
        
        .tools-sidebar {
            flex-direction: column;
        }
        
        .tool-widget {
            min-width: auto;
        }
        
        .quick-actions {
            position: static;
        }
        
        .materials-container {
            max-height: 400px;
        }
    }
</style>

<!-- Modern Classroom Header -->
<div class="classroom-header">
    <div class="container">
        <div class="welcome-section">
            <div class="welcome-content">
                <h1>ROBOTICS CLASSROOM</h1>
                <p class="welcome-subtitle">Welcome back, {{ current_user.first_name }}! Ready to build the future?</p>
            </div>
            <div class="quick-stats">
                <div class="stat-card">
                    <div class="stat-number">{{ enrolled_classes|length }}</div>
                    <div class="stat-label">Active Classes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ projects|length if projects else 0 }}</div>
                    <div class="stat-label">My Projects</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ materials|length if materials else 0 }}</div>
                    <div class="stat-label">Materials</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <!-- Profile Section -->
    <div class="profile-section" style="background: var(--surface-solid); border-radius: var(--radius); padding: 2rem; margin-bottom: 2rem; box-shadow: var(--shadow); border: 1px solid var(--border);">
        <div class="row align-items-center">
            <div class="col-md-3 text-center">
                <div class="profile-picture-container" style="position: relative; display: inline-block;">
                    {% if current_user.profile_picture %}
                        <img src="{{ current_user.profile_picture }}" alt="Profile Picture" 
                             style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 3px solid var(--robotics-primary);">
                    {% else %}
                        <div style="width: 150px; height: 150px; border-radius: 50%; background: var(--robotics-gradient); display: flex; align-items: center; justify-content: center; border: 3px solid var(--robotics-primary); margin: 0 auto;">
                            <i class="fas fa-user" style="font-size: 4rem; color: white;"></i>
                        </div>
                    {% endif %}
                    <div class="profile-actions mt-3">
                        <form method="POST" action="{{ url_for('admin.upload_profile_picture') }}" enctype="multipart/form-data" style="display: inline;">
                            <input type="file" name="profile_picture" accept="image/*" id="profile-upload-{{ current_user.id }}" style="display: none;" onchange="this.form.submit()">
                            <label for="profile-upload-{{ current_user.id }}" class="btn btn-sm" style="background: var(--robotics-primary); color: var(--robotics-dark); border: none; margin-right: 0.5rem; cursor: pointer;">
                                <i class="fas fa-upload me-1"></i>{{ 'Change' if current_user.profile_picture else 'Upload' }}
                            </label>
                        </form>
                        {% if current_user.profile_picture %}
                        <form method="POST" action="{{ url_for('admin.delete_profile_picture') }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete your profile picture?');">
                            <button type="submit" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash me-1"></i>Delete
                            </button>
                        </form>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <h2 style="color: var(--robotics-primary); font-family: var(--font-tech); margin-bottom: 1rem;">
                    <i class="fas fa-user-circle me-2"></i>Profile Information
                </h2>
                <div class="profile-info">
                    {% if current_user.is_school_admin and school %}
                        {# School Dashboard Profile #}
                        {% set school_classes = enrolled_classes|selectattr('class_type', 'equalto', 'school')|list if enrolled_classes else [] %}
                        <div class="info-row mb-2">
                            <strong style="color: var(--text-secondary);">School Name:</strong>
                            <span style="color: var(--on-surface); margin-left: 1rem;">{{ school.school_name }}</span>
                        </div>
                        <div class="info-row mb-2">
                            <strong style="color: var(--text-secondary);">School System ID:</strong>
                            <code style="background: rgba(0, 212, 255, 0.2); color: var(--robotics-accent); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 1rem;">{{ school.school_system_id }}</code>
                        </div>
                        <div class="info-row mb-2">
                            <strong style="color: var(--text-secondary);">Class/Subject:</strong>
                            <span style="color: var(--on-surface); margin-left: 1rem;">
                                {% if school_classes %}
                                    {% for cls in school_classes %}
                                        {{ cls.name }}{% if not loop.last %}, {% endif %}
                                    {% endfor %}
                                {% else %}
                                    N/A
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-row mb-2">
                            <strong style="color: var(--text-secondary);">Associated Entity:</strong>
                            <span style="color: var(--on-surface); margin-left: 1rem;">School</span>
                        </div>
                        {% if id_card %}
                        <div class="info-row mb-2 mt-3">
                            <a href="{{ url_for('admin.view_id_card', id_card_id=id_card.id) }}" 
                               class="btn btn-sm" 
                               style="background: var(--robotics-primary); color: var(--robotics-dark); border: none; width: 100%;">
                                <i class="fas fa-print me-2"></i>Print ID Card
                            </a>
                        </div>
                        {% endif %}
                    {% else %}
                        {# Student Profile - Different for Individual, Group, Family #}
                        {% set first_enrollment = enrollments|first if enrollments else None %}
                        {% set class_type = first_enrollment.class_type if first_enrollment else None %}
                        
                        {% if class_type == 'individual' %}
                            {# Individual Student Profile #}
                            {% set individual_class = enrolled_classes|selectattr('class_type', 'equalto', 'individual')|first if enrolled_classes else None %}
                            {% set student_name = session.get('student_name') or (user.first_name + ' ' + user.last_name if user else '') or (current_user.first_name + ' ' + current_user.last_name if current_user.is_authenticated else '') %}
                            {% set student_system_id = session.get('student_system_id') or (id_card.system_id if id_card else None) or (user.student_id if user else None) or (current_user.student_id if current_user.is_authenticated else None) %}
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Student Name:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ student_name }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Student System ID:</strong>
                                <code style="background: rgba(0, 212, 255, 0.2); color: var(--robotics-accent); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 1rem;">
                                    {% if student_system_id %}{{ student_system_id }}{% else %}Not assigned{% endif %}
                                </code>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Class/Subject:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ individual_class.name if individual_class else 'N/A' }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Associated Entity:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">Student</span>
                            </div>
                        {% elif class_type == 'group' %}
                            {# Group Class Profile #}
                            {% set group_class = enrolled_classes|selectattr('class_type', 'equalto', 'group')|first if enrolled_classes else None %}
                            {% set student_name = session.get('student_name') or (user.first_name + ' ' + user.last_name if user else '') or (current_user.first_name + ' ' + current_user.last_name if current_user.is_authenticated else '') %}
                            {% set group_system_id = session.get('group_system_id') or (id_card.group_system_id if id_card else None) or (group_class.enrollment.group_system_id if group_class and group_class.enrollment else None) %}
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Student Name:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ student_name }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Group Class Name:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ group_class.name if group_class else 'N/A' }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Group System ID:</strong>
                                <code style="background: rgba(0, 212, 255, 0.2); color: var(--robotics-accent); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 1rem;">
                                    {% if group_system_id %}{{ group_system_id }}{% else %}Not assigned{% endif %}
                                </code>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Class/Subject:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ group_class.name if group_class else 'N/A' }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Associated Entity:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">Group</span>
                            </div>
                        {% elif class_type == 'family' %}
                            {# Family Class Profile #}
                            {% set family_class = enrolled_classes|selectattr('class_type', 'equalto', 'family')|first if enrolled_classes else None %}
                            {% set family_name = session.get('student_name') or (user.first_name + ' ' + user.last_name if user else '') or (current_user.first_name + ' ' + current_user.last_name if current_user.is_authenticated else '') %}
                            {% set family_system_id = session.get('family_system_id') or (id_card.family_system_id if id_card else None) or (family_class.enrollment.family_system_id if family_class and family_class.enrollment else None) %}
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Family Name:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ family_name }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Family System ID:</strong>
                                <code style="background: rgba(0, 212, 255, 0.2); color: var(--robotics-accent); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 1rem;">
                                    {% if family_system_id %}{{ family_system_id }}{% else %}Not assigned{% endif %}
                                </code>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Class/Subject:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ family_class.name if family_class else 'N/A' }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Associated Entity:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">Family</span>
                            </div>
                        {% else %}
                            {# Default Student Profile #}
                            {% set default_class = enrolled_classes|first if enrolled_classes else None %}
                            {% set student_name = session.get('student_name') or (user.first_name + ' ' + user.last_name if user else '') or (current_user.first_name + ' ' + current_user.last_name if current_user.is_authenticated else '') %}
                            {% set student_system_id = session.get('student_system_id') or (id_card.system_id if id_card else None) or (user.student_id if user else None) or (current_user.student_id if current_user.is_authenticated else None) %}
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Student Name:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ student_name }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">System ID:</strong>
                                <code style="background: rgba(0, 212, 255, 0.2); color: var(--robotics-accent); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 1rem;">
                                    {% if student_system_id %}{{ student_system_id }}{% else %}Not assigned{% endif %}
                                </code>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Class/Subject:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">{{ default_class.name if default_class else 'N/A' }}</span>
                            </div>
                            <div class="info-row mb-2">
                                <strong style="color: var(--text-secondary);">Associated Entity:</strong>
                                <span style="color: var(--on-surface); margin-left: 1rem;">Student</span>
                            </div>
                        {% endif %}
                        {% if id_card %}
                        <div class="info-row mb-2 mt-3">
                            <a href="{{ url_for('admin.view_id_card', id_card_id=id_card.id) }}" 
                               class="btn btn-sm" 
                               style="background: var(--robotics-primary); color: var(--robotics-dark); border: none; width: 100%;">
                                <i class="fas fa-print me-2"></i>Print ID Card
                            </a>
                        </div>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Main Classroom Layout -->
    <div class="classroom-container">
        <!-- Quick Actions Sidebar -->
        <div class="quick-actions">
            <h3 class="section-title">
                <i class="fas fa-bolt"></i>
                Quick Actions
            </h3>
            
            <a href="https://www.tinkercad.com/joinclass/SCT4QKX8A" class="action-btn" target="_blank">
                <i class="fas fa-robot"></i>
                <span>Tinkercad</span>
                <span class="badge bg-primary">Join</span>
            </a>

            <a href="{{ url_for('store.store') }}" class="action-btn">
                <i class="fas fa-store"></i>
                <span>Browse Classes</span>
            </a>
            
            {% if not current_user.is_admin %}
            <a href="{{ url_for('store.my_courses') }}" class="action-btn">
                <i class="fas fa-book-open"></i>
                <span>My Classes</span>
            </a>
            {% endif %}
            
            <a href="{{ url_for('store.available_classes') }}" class="action-btn">
                <i class="fas fa-chalkboard-teacher"></i>
                <span>Available Classes</span>
            </a>
            
            {% if not current_user.is_admin %}
            <a href="{{ url_for('store.my_course_orders') }}" class="action-btn">
                <i class="fas fa-receipt"></i>
                <span>Class Order</span>
            </a>
            {% endif %}
            
            {# Hide content creation features for school mentors #}
            {% if not current_user.is_school_admin %}
            <a href="{{ url_for('student_projects.student_projects') }}" class="action-btn">
                <i class="fas fa-eye"></i>
                <span>View All Projects</span>
            </a>
            
            {% if not current_user.is_admin %}
            <a href="{{ url_for('student_projects.create_project') }}" class="action-btn">
                <i class="fas fa-plus-circle"></i>
                <span>Create Project</span>
            </a>
            
            <a href="{{ url_for('student_projects.my_projects') }}" class="action-btn">
                <i class="fas fa-user"></i>
                <span>My Projects</span>
            </a>
            {% endif %}
            
            <a href="{{ url_for('integrations.ai_assistant') }}" class="action-btn">
                <i class="fas fa-brain"></i>
                <span>AI Assistant</span>
            </a>
            
            <a href="{{ url_for('projects.robotics_projects') }}" class="action-btn">
                <i class="fas fa-robot"></i>
                <span>Submit Project</span>
            </a>
            
            {% if not current_user.is_admin %}
            {% set cart_count = current_user.cart_items|length if current_user.cart_items else 0 %}
            <a href="{{ url_for('store.cart') }}" class="action-btn">
                <i class="fas fa-shopping-cart"></i>
                <span>Cart</span>
                {% if cart_count > 0 %}
                    <span class="badge bg-danger">{{ cart_count }}</span>
                {% endif %}
            </a>
            {% endif %}
            {% endif %}
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Registration Buttons Section - SCHOOL CLASSES ONLY -->
            {% if enrolled_classes %}
            {% set has_school_classes = enrolled_classes|selectattr('class_type', 'equalto', 'school')|list %}
            {% if has_school_classes %}
            <div class="attendance-section">
                <h2 class="section-title">
                    <i class="fas fa-user-plus"></i>
                    REGISTRATION
                </h2>
                
                {% for cls in enrolled_classes %}
                    {% if cls.class_type == 'school' %}
                    <div class="attendance-card">
                        <div class="attendance-header">
                            <div>
                                <div class="student-name">{{ cls.name }}</div>
                                <small class="text-muted">School Class</small>
                            </div>
                        </div>
                        <div class="mt-3 d-flex gap-2 flex-wrap">
                            <button type="button" class="attendance-btn btn-present" data-bs-toggle="modal" data-bs-target="#registerStudentModal{{ cls.id }}">
                                <i class="fas fa-user-graduate"></i> REGISTER YOUR STUDENTS
                            </button>
                            {% if registered_students.get(cls.id) %}
                            <button type="button" class="attendance-btn" style="background: var(--robotics-primary);" data-bs-toggle="modal" data-bs-target="#viewStudentsModal{{ cls.id }}">
                                <i class="fas fa-users"></i> VIEW REGISTERED STUDENTS ({{ registered_students[cls.id]|length }})
                            </button>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            {% endif %}
            {% endif %}


            <!-- Live Classes Section - Only visible when current time matches student's class time -->
            {% if active_live_class %}
            <div class="attendance-section" style="margin-bottom: 2rem;">
                <h2 class="section-title" style="color: var(--robotics-accent);">
                    <i class="fas fa-video"></i>
                    LIVE CLASSES
                </h2>
                <div class="attendance-card" style="background: var(--surface-solid); border: 2px solid var(--robotics-accent);">
                    <div class="attendance-header">
                        <div>
                            <div class="student-name" style="color: var(--robotics-accent); font-size: 1.5rem;">
                                <i class="fas fa-circle" style="color: #ff0000; animation: pulse 2s infinite;"></i>
                                LIVE CLASS IN SESSION
                            </div>
                            <small class="text-muted">Join the live class meeting now</small>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <i class="fas fa-calendar-day me-1"></i>{{ active_live_class.class_time.day }}
                                    <i class="fas fa-clock me-1 ms-2"></i>{{ active_live_class.class_time.get_display_time(student_timezone) }}
                                    <i class="fas fa-book me-1 ms-2"></i>{{ active_live_class.class.name if active_live_class.class else 'Class' }}
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3" style="border-radius: var(--radius-sm); overflow: hidden; background: #000; min-height: 500px;">
                        <iframe 
                            allow="camera; microphone; fullscreen; display-capture; autoplay" 
                            src="https://meet.jit.si/SportingDimensionsEmphasizeGenerally" 
                            style="height: 600px; width: 100%; border: 0px; display: block;">
                        </iframe>
                    </div>
                    
                    <div class="mt-3">
                        <div class="alert" style="background: rgba(57, 255, 20, 0.1); border: 1px solid var(--robotics-accent); color: var(--on-surface);">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Instructions:</strong> Click "Allow" when prompted to enable your camera and microphone for the live class.
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Learning Materials Feed -->
            <div class="materials-feed">
                <div class="feed-header">
                    <div>
                        <h3 style="margin: 0; font-weight: 600;">
                            <i class="fas fa-stream me-2"></i>
                            LEARNING MATERIALS
                        </h3>
                        <small style="opacity: 0.9;">Latest updates from your classes</small>
                    </div>
                    <div class="feed-controls">
                        <button class="feed-btn active" onclick="filterMaterials('all')">All</button>
                        <button class="feed-btn" onclick="filterMaterials('today')">Today</button>
                        <button class="feed-btn" onclick="filterMaterials('week')">This Week</button>
                    </div>
                </div>
                
                <div class="materials-container" id="materials-container">
                    {% if materials %}
                        {% for material in materials %}
                            <div class="material-item" data-date="{{ material.created_at.strftime('%Y-%m-%d') }}">
                                <div class="material-header">
                                    <span class="class-badge">{{ material.class_name() }}</span>
                                    <div class="material-time">
                                        <i class="fas fa-clock"></i>
                                        {{ material.created_at.strftime('%b %d, %Y') }}
                                    </div>
                                </div>
                                
                                <div class="material-content" id="material-{{ material.id }}">
                                    <!-- YouTube Video -->
                                    {% if material.material_type == 'youtube' and material.youtube_url %}
                                        {% set youtube_id = material.youtube_url.split('v=')[1].split('&')[0] if 'v=' in material.youtube_url else (material.youtube_url.split('youtu.be/')[1].split('?')[0] if 'youtu.be/' in material.youtube_url else material.youtube_url.split('/')[-1]) %}
                                        <div class="youtube-embed-container" style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin-bottom: 1rem; border-radius: var(--radius-sm); overflow: hidden; background: #000;">
                                            <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" 
                                                    src="https://www.youtube.com/embed/{{ youtube_id }}?rel=0" 
                                                    frameborder="0" 
                                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                                    allowfullscreen></iframe>
                                        </div>
                                    {% endif %}
                                    
                                    <!-- Uploaded Image -->
                                    {% if material.material_type == 'image' and material.file_url %}
                                        <div class="material-image-container" style="margin-bottom: 1rem;">
                                            <img src="{{ material.file_url }}" 
                                                 alt="{{ material.file_name or 'Learning Material Image' }}" 
                                                 style="max-width: 100%; height: auto; border-radius: var(--radius-sm); cursor: pointer;"
                                                 onclick="openImageModal('{{ material.file_url }}', '{{ material.file_name or 'Image' }}')">
                                        </div>
                                    {% endif %}
                                    
                                    <!-- Uploaded Video -->
                                    {% if material.material_type == 'video' and material.file_url %}
                                        <div class="material-video-container" style="margin-bottom: 1rem;">
                                            <video controls style="width: 100%; max-height: 500px; border-radius: var(--radius-sm);">
                                                <source src="{{ material.file_url }}" type="video/{{ material.file_type or 'mp4' }}">
                                                Your browser does not support the video tag.
                                            </video>
                                        </div>
                                    {% endif %}
                                    
                                    <!-- PDF Viewer -->
                                    {% if material.material_type == 'pdf' and material.file_url %}
                                        <div class="material-pdf-container" style="margin-bottom: 1rem; border: 1px solid var(--border); border-radius: var(--radius-sm); overflow: hidden;">
                                            <iframe src="{{ material.file_url }}#toolbar=1" 
                                                    style="width: 100%; height: 600px; border: none;"
                                                    type="application/pdf">
                                            </iframe>
                                            <div style="padding: 0.5rem; background: var(--surface); text-align: center;">
                                                <a href="{{ material.file_url }}" target="_blank" style="color: var(--robotics-primary); text-decoration: none;">
                                                    <i class="fas fa-download me-2"></i>Download PDF: {{ material.file_name or 'Document' }}
                                                </a>
                                            </div>
                                        </div>
                                    {% endif %}
                                    
                                    <!-- Text Content -->
                                    <div onclick="toggleExpand({{ material.id }})" style="cursor: pointer;">
                                        {{ material.content|urlize(target='_blank')|safe }}
                                    </div>
                                </div>
                                
                                <div class="material-actions">
                                    <button class="material-action" onclick="bookmarkMaterial({{ material.id }})">
                                        <i class="fas fa-bookmark"></i>
                                        Bookmark
                                    </button>
                                    <button class="material-action" onclick="shareMaterial({{ material.id }})">
                                        <i class="fas fa-share"></i>
                                        Share
                                    </button>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <i class="fas fa-book-open"></i>
                            <h4>No learning materials yet</h4>
                            <p>Materials shared by your instructors will appear here.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Tools & Widgets Sidebar -->
        <div class="tools-sidebar">
            <!-- Class Schedule Card (TOP PRIORITY) -->
            {% if enrolled_classes %}
            <div class="tool-widget" style="background: var(--surface-solid); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 1.5rem; margin-bottom: 1.5rem;">
                <h4 class="section-title" style="color: var(--robotics-primary); margin-bottom: 1rem;">
                    <i class="fas fa-clock me-2"></i>
                    Class Schedule
                </h4>
                
                <!-- Timezone Selector (Small) -->
                <div class="mb-3">
                    <form method="POST" action="{{ url_for('main.update_timezone') }}" class="d-inline" style="width: 100%;">
                        <select name="timezone" class="form-select form-select-sm" style="width: 100%; background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);" onchange="this.form.submit()">
                            <option value="Asia/Kolkata" {% if student_timezone == 'Asia/Kolkata' %}selected{% endif %}>India (IST)</option>
                            <option value="Africa/Banjul" {% if student_timezone == 'Africa/Banjul' %}selected{% endif %}>Gambia (GMT)</option>
                            <option value="Africa/Lagos" {% if student_timezone == 'Africa/Lagos' %}selected{% endif %}>Nigeria (WAT)</option>
                            <option value="Africa/Cairo" {% if student_timezone == 'Africa/Cairo' %}selected{% endif %}>Egypt (EET)</option>
                            <option value="Africa/Johannesburg" {% if student_timezone == 'Africa/Johannesburg' %}selected{% endif %}>South Africa (SAST)</option>
                            <option value="Europe/London" {% if student_timezone == 'Europe/London' %}selected{% endif %}>UK (GMT/BST)</option>
                            <option value="Europe/Paris" {% if student_timezone == 'Europe/Paris' %}selected{% endif %}>France (CET/CEST)</option>
                            <option value="Europe/Berlin" {% if student_timezone == 'Europe/Berlin' %}selected{% endif %}>Germany (CET/CEST)</option>
                            <option value="America/New_York" {% if student_timezone == 'America/New_York' %}selected{% endif %}>USA - Eastern</option>
                            <option value="America/Los_Angeles" {% if student_timezone == 'America/Los_Angeles' %}selected{% endif %}>USA - Pacific</option>
                            <option value="Asia/Dubai" {% if student_timezone == 'Asia/Dubai' %}selected{% endif %}>UAE (GST)</option>
                            <option value="Asia/Singapore" {% if student_timezone == 'Asia/Singapore' %}selected{% endif %}>Singapore (SGT)</option>
                            <option value="Asia/Tokyo" {% if student_timezone == 'Asia/Tokyo' %}selected{% endif %}>Japan (JST)</option>
                            <option value="Australia/Sydney" {% if student_timezone == 'Australia/Sydney' %}selected{% endif %}>Australia - Sydney</option>
                        </select>
                    </form>
                    <small class="text-muted d-block mt-1" style="font-size: 0.75rem;">
                        <i class="fas fa-globe me-1"></i>Times are automatically converted to your local country time.
                    </small>
                </div>
                
                <!-- Class Time Display for Each Enrolled Class -->
                {% for cls in enrolled_classes %}
                    <div class="mb-3" style="padding: 1rem; background: var(--surface); border-radius: var(--radius-sm); border: 1px solid var(--border);">
                        <div style="font-weight: 600; color: var(--robotics-primary); margin-bottom: 0.5rem;">
                            {{ cls.name }}
                        </div>
                        
                        {% if cls.class_type == 'individual' or cls.class_type == 'family' %}
                            {% set available_times = class_times_by_type.get(cls.class_type, []) %}
                            {% set current_selection = student_time_selections.get(cls.enrollment.id) %}
                            
                            {% if current_selection and current_selection.class_time %}
                                <div style="margin-bottom: 0.5rem;">
                                    <div style="color: var(--on-surface);">
                                        <i class="fas fa-calendar-day me-1"></i><strong>{{ current_selection.class_time.day }}</strong>
                                    </div>
                                    <div style="color: var(--robotics-accent); font-size: 1.1rem; font-weight: 600;">
                                        <i class="fas fa-clock me-1"></i>{{ current_selection.class_time.get_display_time(student_timezone) }}
                                    </div>
                                    <small class="text-muted d-block mt-1">
                                        <i class="fas fa-globe me-1"></i>{{ student_timezone|replace('_', ' ')|replace('/', ' - ') }}
                                    </small>
                                </div>
                                
                                {% if available_times|length > 1 %}
                                    <div class="mt-2">
                                        <button class="btn btn-sm" style="background: var(--robotics-gradient); color: white; border: none; width: 100%;" type="button" data-bs-toggle="collapse" data-bs-target="#timeOptions{{ cls.id }}" aria-expanded="false">
                                            <i class="fas fa-chevron-down me-1"></i>Change Time
                                        </button>
                                        <div class="collapse mt-2" id="timeOptions{{ cls.id }}">
                                            {% for time_slot in available_times %}
                                                {% if current_selection.class_time_id != time_slot.id %}
                                                    <form method="POST" action="{{ url_for('main.select_class_time') }}" style="margin-bottom: 0.5rem;">
                                                        <input type="hidden" name="time_id" value="{{ time_slot.id }}">
                                                        <button type="submit" class="btn btn-sm btn-outline-primary" style="width: 100%; text-align: left;">
                                                            <i class="fas fa-calendar-day me-1"></i>{{ time_slot.day }} {{ time_slot.get_display_time(student_timezone) }}
                                                        </button>
                                                    </form>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% endif %}
                            {% elif available_times %}
                                <div class="alert alert-warning" style="background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); padding: 0.75rem; font-size: 0.875rem;">
                                    <i class="fas fa-exclamation-circle me-1"></i>Please select a time:
                                </div>
                                {% for time_slot in available_times %}
                                    <form method="POST" action="{{ url_for('main.select_class_time') }}" style="margin-bottom: 0.5rem;">
                                        <input type="hidden" name="time_id" value="{{ time_slot.id }}">
                                        <button type="submit" class="btn btn-sm btn-primary" style="width: 100%; text-align: left;">
                                            <i class="fas fa-calendar-day me-1"></i>{{ time_slot.day }} {{ time_slot.get_display_time(student_timezone) }}
                                        </button>
                                    </form>
                                {% endfor %}
                            {% else %}
                                <div class="text-muted" style="font-size: 0.875rem;">
                                    <i class="fas fa-info-circle me-1"></i>No times available yet
                                </div>
                            {% endif %}
                            
                        {% elif cls.class_type == 'group' or cls.class_type == 'school' %}
                            {% set fixed_times = class_times_by_type.get(cls.class_type, []) %}
                            
                            {% if fixed_times %}
                                {% for time_slot in fixed_times %}
                                    <div style="margin-bottom: 0.5rem;">
                                        <div style="color: var(--on-surface);">
                                            <i class="fas fa-calendar-day me-1"></i><strong>{{ time_slot.day }}</strong>
                                        </div>
                                        <div style="color: var(--robotics-accent); font-size: 1.1rem; font-weight: 600;">
                                            <i class="fas fa-clock me-1"></i>{{ time_slot.get_display_time(student_timezone) }}
                                        </div>
                                        <small class="text-muted d-block mt-1">
                                            <i class="fas fa-globe me-1"></i>{{ student_timezone|replace('_', ' ')|replace('/', ' - ') }}
                                        </small>
                                        <small class="text-muted d-block" style="font-size: 0.75rem; margin-top: 0.25rem;">
                                            <i class="fas fa-info-circle me-1"></i>Fixed schedule
                                        </small>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <div class="text-muted" style="font-size: 0.875rem;">
                                    <i class="fas fa-info-circle me-1"></i>Schedule will be announced soon
                                </div>
                            {% endif %}
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Live Clock Widget -->
            <div class="tool-widget clock-widget">
                <div class="current-time" id="current-time">--:--</div>
                <div class="current-date" id="current-date">--</div>
            </div>

            <!-- Quick Calendar -->
            <div class="tool-widget calendar-widget">
                <h4 class="section-title" style="color: white; margin-bottom: 1rem;">
                    <i class="fas fa-calendar-alt"></i>
                    Calendar
                </h4>
                <div class="calendar-header" id="calendar-month">-- 2024</div>
                <div class="calendar-grid" id="calendar-grid">
                    <!-- Calendar will be generated by JavaScript -->
                </div>
            </div>

            <!-- Quick Notes -->
            <div class="tool-widget notes-widget">
                <h4 class="section-title">
                    <i class="fas fa-sticky-note"></i>
                    Quick Notes
                </h4>
                <textarea placeholder="Jot down your thoughts..." id="quick-notes"></textarea>
                <button class="btn btn-sm mt-2" style="background: var(--robotics-gradient); color: white; border: none; border-radius: 20px; padding: 0.5rem 1rem;" onclick="saveNotes()">
                    <i class="fas fa-save me-1"></i>Save
                </button>
            </div>

            <!-- Learning Progress -->
            {% if enrolled_classes %}
            <div class="tool-widget">
                <h4 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Progress
                </h4>
                
                {% for cls in enrolled_classes %}
                <div class="progress-item">
                    <span class="progress-label">{{ cls.name }}</span>
                    <div class="progress-bar-container">
                        <div class="progress-fill" style="width: {{ monthly_stats[cls.id].percentage }}%;"></div>
                    </div>
                    <small class="text-muted">{{ monthly_stats[cls.id].percentage }}%</small>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Registration Modals -->
{% for cls in enrolled_classes %}
    {% if cls.class_type == 'school' %}
    <!-- Register Student Modal -->
    <div class="modal fade" id="registerStudentModal{{ cls.id }}" tabindex="-1" aria-labelledby="registerStudentModalLabel{{ cls.id }}" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="background: var(--surface-solid); border: 1px solid var(--border); color: var(--on-surface);">
                <div class="modal-header" style="border-bottom: 1px solid var(--border);">
                    <h5 class="modal-title" id="registerStudentModalLabel{{ cls.id }}" style="color: var(--robotics-primary);">
                        <i class="fas fa-user-graduate me-2"></i>Register Student - {{ cls.name }}
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <form method="POST" action="{{ url_for('admin.register_student') }}" enctype="multipart/form-data">
                    <div class="modal-body">
                        <input type="hidden" name="enrollment_id" value="{{ cls.enrollment.id }}">
                        <input type="hidden" name="class_id" value="{{ cls.id }}">
                        
                        <div class="mb-3">
                            <label class="form-label">School Name *</label>
                            <input type="text" class="form-control" name="school_name" required style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Student Name *</label>
                            <input type="text" class="form-control" name="student_name" required style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Student Age</label>
                                <input type="number" class="form-control" name="student_age" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Student Email</label>
                                <input type="email" class="form-control" name="student_email" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Student Phone</label>
                            <input type="text" class="form-control" name="student_phone" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Student Photo</label>
                            <input type="file" class="form-control" name="student_image" accept="image/*" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <hr style="border-color: var(--border);">
                        
                        <h6 style="color: var(--robotics-primary);">Parent/Guardian Information</h6>
                        
                        <div class="mb-3">
                            <label class="form-label">Parent Name</label>
                            <input type="text" class="form-control" name="parent_name" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Parent Phone</label>
                                <input type="text" class="form-control" name="parent_phone" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Parent Email</label>
                                <input type="email" class="form-control" name="parent_email" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Additional Information</label>
                            <textarea class="form-control" name="additional_info" rows="3" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer" style="border-top: 1px solid var(--border);">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="background: var(--surface); border: 1px solid var(--border);">Cancel</button>
                        <button type="submit" class="btn btn-primary" style="background: var(--robotics-gradient); border: none;">Register Student</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% elif cls.class_type == 'family' %}
    {# Family registration removed - Registration only for School Classes #}
    {% if False %}
    <div class="modal fade" id="registerFamilyModal{{ cls.id }}" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="background: var(--surface-solid); border: 1px solid var(--border); color: var(--on-surface);">
                <div class="modal-header" style="border-bottom: 1px solid var(--border);">
                    <h5 class="modal-title" id="registerFamilyModalLabel{{ cls.id }}" style="color: var(--robotics-primary);">
                        <i class="fas fa-users me-2"></i>Register Family Member - {{ cls.name }}
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <form method="POST" action="{{ url_for('admin.register_family_member') }}" enctype="multipart/form-data">
                    <div class="modal-body">
                        <input type="hidden" name="enrollment_id" value="{{ cls.enrollment.id }}">
                        <input type="hidden" name="class_id" value="{{ cls.id }}">
                        
                        <div class="mb-3">
                            <label class="form-label">Member Name *</label>
                            <input type="text" class="form-control" name="member_name" required style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Member Age</label>
                                <input type="number" class="form-control" name="member_age" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Relationship</label>
                                <select class="form-control" name="relationship" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                                    <option value="">Select Relationship</option>
                                    <option value="Son">Son</option>
                                    <option value="Daughter">Daughter</option>
                                    <option value="Brother">Brother</option>
                                    <option value="Sister">Sister</option>
                                    <option value="Cousin">Cousin</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Member Email</label>
                                <input type="email" class="form-control" name="member_email" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Member Phone</label>
                                <input type="text" class="form-control" name="member_phone" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Member Photo</label>
                            <input type="file" class="form-control" name="member_image" accept="image/*" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Additional Information</label>
                            <textarea class="form-control" name="additional_info" rows="3" style="background: var(--surface); border: 1px solid var(--border); color: var(--on-surface);"></textarea>
                        </div>
                        
                        {% if registered_family.get(cls.id) %}
                        <div class="alert alert-info" style="background: rgba(0, 212, 255, 0.1); border: 1px solid var(--robotics-primary); color: var(--on-surface);">
                            <i class="fas fa-info-circle me-2"></i>
                            You have registered {{ registered_family[cls.id]|length }} family member(s). Maximum 4 family members allowed.
                        </div>
                        {% endif %}
                    </div>
                    <div class="modal-footer" style="border-top: 1px solid var(--border);">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="background: var(--surface); border: 1px solid var(--border);">Cancel</button>
                        <button type="submit" class="btn btn-primary" style="background: var(--robotics-gradient); border: none;">Register Family Member</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
    {% endif %}
    
    <!-- View Registered Students Modal for School Classes -->
    {% if cls.class_type == 'school' and registered_students.get(cls.id) %}
    <div class="modal fade" id="viewStudentsModal{{ cls.id }}" tabindex="-1" aria-labelledby="viewStudentsModalLabel{{ cls.id }}" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="background: var(--surface-solid); border: 1px solid var(--border); color: var(--on-surface);">
                <div class="modal-header" style="border-bottom: 1px solid var(--border);">
                    <h5 class="modal-title" id="viewStudentsModalLabel{{ cls.id }}" style="color: var(--robotics-primary);">
                        <i class="fas fa-users me-2"></i>Registered Students - {{ cls.name }}
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info" style="background: rgba(0, 212, 255, 0.1); border: 1px solid var(--robotics-primary); color: var(--on-surface);">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Total Students:</strong> {{ registered_students[cls.id]|length }} registered in this class
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-hover" style="color: var(--on-surface);">
                            <thead style="background: var(--surface);">
                                <tr>
                                    <th>#</th>
                                    <th>Student Name</th>
                                    <th>Student ID</th>
                                    <th>Attendance (Today)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for student in registered_students[cls.id] %}
                                {% set student_key = 'school_student_' ~ student.id %}
                                {% set today_att = all_students_today_attendance.get(cls.id, {}).get(student_key) %}
                                <tr>
                                    <td>{{ loop.index }}</td>
                                    <td>
                                        <strong>{{ student.student_name }}</strong>
                                        {% if student.student_image_url %}
                                        <br><img src="{{ student.student_image_url }}" alt="{{ student.student_name }}" style="width: 40px; height: 40px; border-radius: 50%; margin-top: 5px; object-fit: cover;">
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if student.student_system_id %}
                                            <span class="badge bg-info"><code>{{ student.student_system_id }}</code></span>
                                        {% else %}
                                            <span class="badge bg-secondary">ID: {{ student.id }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if today_att %}
                                            {% if today_att.status == 'present' %}
                                                <span class="badge bg-success"> PRESENT</span>
                                            {% else %}
                                                <span class="badge bg-danger"> ABSENT</span>
                                            {% endif %}
                                        {% else %}
                                            <span class="badge bg-secondary">Not Marked</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if today_att %}
                                            <form method="POST" action="{{ url_for('admin.mark_attendance') }}" style="display: inline;">
                                                <input type="hidden" name="school_student_id" value="{{ student.id }}">
                                                <input type="hidden" name="class_id" value="{{ cls.id }}">
                                                <input type="hidden" name="class_type" value="{{ cls.class_type }}">
                                                <input type="hidden" name="status" value="present">
                                                <button type="submit" class="btn btn-sm btn-success" style="margin-right: 0.25rem;">
                                                    <i class="fas fa-check"></i> Present
                                                </button>
                                            </form>
                                            <form method="POST" action="{{ url_for('admin.mark_attendance') }}" style="display: inline;">
                                                <input type="hidden" name="school_student_id" value="{{ student.id }}">
                                                <input type="hidden" name="class_id" value="{{ cls.id }}">
                                                <input type="hidden" name="class_type" value="{{ cls.class_type }}">
                                                <input type="hidden" name="status" value="absent">
                                                <button type="submit" class="btn btn-sm btn-danger">
                                                    <i class="fas fa-times"></i> Absent
                                                </button>
                                            </form>
                                        {% else %}
                                            <form method="POST" action="{{ url_for('admin.mark_attendance') }}" style="display: inline;">
                                                <input type="hidden" name="school_student_id" value="{{ student.id }}">
                                                <input type="hidden" name="class_id" value="{{ cls.id }}">
                                                <input type="hidden" name="class_type" value="{{ cls.class_type }}">
                                                <input type="hidden" name="status" value="present">
                                                <button type="submit" class="btn btn-sm btn-success" style="margin-right: 0.25rem;">
                                                    <i class="fas fa-check"></i> Present
                                                </button>
                                            </form>
                                            <form method="POST" action="{{ url_for('admin.mark_attendance') }}" style="display: inline;">
                                                <input type="hidden" name="school_student_id" value="{{ student.id }}">
                                                <input type="hidden" name="class_id" value="{{ cls.id }}">
                                                <input type="hidden" name="class_type" value="{{ cls.class_type }}">
                                                <input type="hidden" name="status" value="absent">
                                                <button type="submit" class="btn btn-sm btn-danger">
                                                    <i class="fas fa-times"></i> Absent
                                                </button>
                                            </form>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    {% if registered_students[cls.id]|length == 0 %}
                    <div class="text-center py-4">
                        <i class="fas fa-user-slash fa-3x mb-3" style="color: var(--border);"></i>
                        <p class="text-muted">No students registered in this class yet.</p>
                    </div>
                    {% endif %}
                </div>
                <div class="modal-footer" style="border-top: 1px solid var(--border);">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="background: var(--surface); border: 1px solid var(--border);">Close</button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
{% endfor %}

<script>
// Initialize the modern classroom
document.addEventListener('DOMContentLoaded', function() {
    updateClock();
    generateCalendar();
    loadSavedNotes();
    processYouTubeLinksInContent();
    
    setInterval(updateClock, 1000);
});

// Process YouTube links in material content (for backward compatibility)
function processYouTubeLinksInContent() {
    const materialContents = document.querySelectorAll('.material-content');
    materialContents.forEach(function(contentDiv) {
        // Skip if already has YouTube embed
        if (contentDiv.querySelector('.youtube-embed-container')) {
            return;
        }
        
        const text = contentDiv.innerHTML;
        // Match YouTube URLs
        const youtubeRegex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/g;
        let match;
        let hasYouTube = false;
        
        while ((match = youtubeRegex.exec(text)) !== null) {
            hasYouTube = true;
            const videoId = match[1];
            const youtubeUrl = match[0];
            
            // Create embed container
            const embedContainer = document.createElement('div');
            embedContainer.className = 'youtube-embed-container';
            embedContainer.style.cssText = 'position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin-bottom: 1rem; border-radius: var(--radius-sm); overflow: hidden; background: #000;';
            
            const iframe = document.createElement('iframe');
            iframe.src = `https://www.youtube.com/embed/${videoId}?rel=0`;
            iframe.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%;';
            iframe.frameBorder = '0';
            iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
            iframe.allowFullscreen = true;
            
            embedContainer.appendChild(iframe);
            
            // Replace the YouTube link in content with embed
            contentDiv.innerHTML = contentDiv.innerHTML.replace(youtubeUrl, '');
            contentDiv.insertBefore(embedContainer, contentDiv.firstChild);
        }
    });
}

// Real-time clock
function updateClock() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('en-US', { 
        hour12: false,
        hour: '2-digit',
        minute: '2-digit'
    });
    const dateString = now.toLocaleDateString('en-US', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    document.getElementById('current-time').textContent = timeString;
    document.getElementById('current-date').textContent = dateString;
}

// Generate calendar
function generateCalendar() {
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth();
    const today = now.getDate();
    
    const monthNames = [
        'January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'
    ];
    
    document.getElementById('calendar-month').textContent = `${monthNames[month]} ${year}`;
    
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    
    const calendarGrid = document.getElementById('calendar-grid');
    calendarGrid.innerHTML = '';

    // Day headers
    const dayHeaders = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
    dayHeaders.forEach(day => {
        const header = document.createElement('div');
        header.className = 'calendar-day';
        header.textContent = day;
        header.style.fontWeight = '600';
        header.style.opacity = '0.7';
        calendarGrid.appendChild(header);
    });

    // Fill empty days before the first day of the month
    for (let i = 0; i < firstDay; i++) {
        const emptyCell = document.createElement('div');
        emptyCell.className = 'calendar-day';
        emptyCell.style.visibility = 'hidden';
        calendarGrid.appendChild(emptyCell);
    }

    // Fill days of the month
    for (let day = 1; day <= daysInMonth; day++) {
        const dayCell = document.createElement('div');
        dayCell.className = 'calendar-day';
        if (day === today) {
            dayCell.classList.add('today');
        }
        dayCell.textContent = day;
        calendarGrid.appendChild(dayCell);
    }
}

// Filter materials by time frame
function filterMaterials(timeFrame) {
    const allMaterials = document.querySelectorAll('.material-item');
    const buttons = document.querySelectorAll('.feed-btn');
    
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    allMaterials.forEach(material => {
        material.style.display = 'block';
        
        const materialDate = new Date(material.getAttribute('data-date'));
        const today = new Date();
        const oneWeekAgo = new Date();
        oneWeekAgo.setDate(today.getDate() - 7);
        
        if (timeFrame === 'today' && materialDate.toDateString() !== today.toDateString()) {
            material.style.display = 'none';
        } else if (timeFrame === 'week' && materialDate < oneWeekAgo) {
            material.style.display = 'none';
        }
    });
}

// Toggle material expansion
function toggleExpand(materialId) {
    const content = document.getElementById('material-' + materialId);
    content.classList.toggle('expanded');
}

// Save notes to local storage
function saveNotes() {
    const notesContent = document.getElementById('quick-notes').value;
    localStorage.setItem('quickNotes', notesContent);
    alert('Notes saved!');
}

// Load saved notes from local storage
function loadSavedNotes() {
    const savedNotes = localStorage.getItem('quickNotes');
    if (savedNotes) {
        document.getElementById('quick-notes').value = savedNotes;
    }
}

// Bookmark material: copy content to clipboard
function bookmarkMaterial(materialId) {
    const content = document.getElementById('material-' + materialId).innerText;
    if (navigator.clipboard) {
        navigator.clipboard.writeText(content).then(function() {
            alert('Material content copied to clipboard!');
        }, function() {
            alert('Failed to copy content.');
        });
    } else {
        alert('Clipboard not supported.');
    }
}

// Share material: use Web Share API or fallback to copy
function shareMaterial(materialId) {
    const materialElement = document.getElementById('material-' + materialId);
    const content = materialElement.innerText;
    const materialUrl = window.location.href + '#material-' + materialId;
    
    if (navigator.share) {
        navigator.share({
            title: 'Learning Material',
            text: content,
            url: materialUrl
        }).catch(() => {
            // User cancelled or not supported
        });
    } else if (navigator.clipboard) {
        navigator.clipboard.writeText(materialUrl).then(function() {
            alert('Material link copied! You can now share it.');
        });
    } else {
        // Fallback: show share dialog
        const shareText = `Check out this learning material:\n\n${content}\n\n${materialUrl}`;
        prompt('Copy this link to share:', materialUrl);
    }
}

// Open image in modal for full-size viewing
function openImageModal(imageUrl, imageTitle) {
    // Create modal if it doesn't exist
    let modal = document.getElementById('imageModal');
    if (!modal) {
        modal = document.createElement('div');
        modal.id = 'imageModal';
        modal.className = 'modal fade';
        modal.innerHTML = `
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content" style="background: var(--surface-solid); border: 1px solid var(--border);">
                    <div class="modal-header" style="border-bottom: 1px solid var(--border);">
                        <h5 class="modal-title" style="color: var(--robotics-primary);" id="imageModalTitle"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                    </div>
                    <div class="modal-body text-center" style="padding: 0;">
                        <img id="modalImage" src="" alt="" style="max-width: 100%; height: auto; border-radius: 0;">
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }
    
    document.getElementById('modalImage').src = imageUrl;
    document.getElementById('modalImage').alt = imageTitle;
    document.getElementById('imageModalTitle').textContent = imageTitle;
    
    const bsModal = new bootstrap.Modal(modal);
    bsModal.show();
}

// Extract YouTube ID from URL
function extractYouTubeId(url) {
    const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
    const match = url.match(regExp);
    return (match && match[8].length === 11) ? match[8] : null;
}
</script>
{% endblock %}
