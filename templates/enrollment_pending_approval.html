{% extends "base.html" %}

{% block content %}
<style>
    :root {
        --robotics-primary: #00d4ff;
        --robotics-secondary: #ff6b35;
        --robotics-accent: #39ff14;
        --robotics-dark: #0a0a1a;
        --surface-solid: rgba(5, 5, 16, 0.9);
        --border: rgba(0, 212, 255, 0.3);
    }

    body {
        background: var(--robotics-dark);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
    }

    .approval-card {
        background: var(--surface-solid);
        border: 2px solid var(--border);
        border-radius: 25px;
        padding: 3rem;
        max-width: 600px;
        text-align: center;
        box-shadow: 0 0 50px rgba(0, 212, 255, 0.2);
    }

    .approval-icon {
        font-size: 5rem;
        color: var(--robotics-primary);
        animation: pulse 2s infinite;
        margin-bottom: 2rem;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.1); }
    }

    .approval-title {
        font-family: 'Orbitron', sans-serif;
        font-size: 2rem;
        font-weight: 700;
        color: var(--robotics-primary);
        margin-bottom: 1rem;
    }

    .enrollment-info {
        background: rgba(0, 212, 255, 0.1);
        border: 1px solid var(--border);
        border-radius: 15px;
        padding: 1.5rem;
        margin: 2rem 0;
        text-align: left;
    }

    .info-item {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .info-item:last-child {
        border-bottom: none;
    }

    .info-label {
        color: rgba(255, 255, 255, 0.7);
        font-weight: 500;
    }

    .info-value {
        color: white;
        font-weight: 600;
    }

    .status-badge {
        display: inline-block;
        padding: 0.5rem 1.5rem;
        border-radius: 25px;
        background: rgba(255, 193, 7, 0.2);
        border: 1px solid #ffc107;
        color: #ffc107;
        font-weight: 600;
        margin: 1rem 0;
    }

    .spinner {
        border: 3px solid rgba(0, 212, 255, 0.3);
        border-top: 3px solid var(--robotics-primary);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 2rem auto;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .message {
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.6;
        margin: 1.5rem 0;
    }
</style>

<div class="container">
    <div class="approval-card">
        <div class="approval-icon">
            <i class="fas fa-clock"></i>
        </div>
        
        <h2 class="approval-title">Waiting for Approval</h2>
        
        {% if enrollment %}
        <div class="enrollment-info">
            <div class="info-item">
                <span class="info-label">Student Name:</span>
                <span class="info-value">{{ enrollment.customer_name }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Class Type:</span>
                <span class="info-value">{{ enrollment.class_type|title }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Amount Paid:</span>
                <span class="info-value">${{ enrollment.amount|int }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Payment Method:</span>
                <span class="info-value">{{ enrollment.payment_method|title }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Registration Date:</span>
                <span class="info-value">{{ enrollment.enrolled_at.strftime('%B %d, %Y') if enrollment.enrolled_at else 'N/A' }}</span>
            </div>
        </div>
        {% endif %}
        
        <div class="status-badge">
            <i class="fas fa-hourglass-half me-2"></i>Pending Approval
        </div>
        
        <p class="message">
            Your registration has been submitted successfully and your payment receipt has been received.
            Our admin team is reviewing your payment. You will receive your Student ID via email once your payment is approved.
        </p>
        
        <div class="spinner"></div>
        
        <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.9rem; margin-top: 2rem;">
            <i class="fas fa-info-circle me-2"></i>
            This page will automatically update once your registration is approved.
        </p>
        
        <div style="margin-top: 2rem;">
            <a href="{{ url_for('main.index') }}" class="btn" style="background: var(--robotics-primary); color: var(--robotics-dark); border: none; padding: 0.75rem 2rem; border-radius: 10px; text-decoration: none; font-weight: 600;">
                <i class="fas fa-home me-2"></i>Back to Home
            </a>
        </div>
    </div>
</div>

<script>
// Auto-refresh every 30 seconds to check approval status
setInterval(function() {
    fetch(window.location.href)
        .then(response => response.text())
        .then(html => {
            // Check if status changed (enrollment approved)
            if (!html.includes('Pending Approval') || html.includes('Student ID')) {
                window.location.reload();
            }
        })
        .catch(() => {
            // Silently fail, will retry on next interval
        });
}, 30000);
</script>
{% endblock %}

