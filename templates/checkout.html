<!-- templates/checkout.html -->
{% extends "base.html" %}

{% block title %}Course Checkout - LMS{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2><i class="fas fa-credit-card"></i> Course Checkout</h2>
    
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-credit-card"></i> Payment & Shipping Information</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('process_payment') }}" enctype="multipart/form-data">
                        <!-- Payment Method Selection -->
                        <div class="mb-4">
                            <label class="form-label"><strong>Select a Payment Method</strong></label>
                            
                            <!-- Direct Bank Transfer -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="payment_method" value="bank_transfer" id="bank_transfer" checked>
                                <label class="form-check-label" for="bank_transfer">
                                    <strong>4️⃣ Direct Bank Transfer</strong>
                                </label>
                            </div>
                            <div class="ms-4 mb-3 text-muted">
                                <small>
                                    <strong>Bank:</strong> Ecobank Gambia<br>
                                    <strong>Name:</strong> Abdoukadir Jabbie<br>
                                    <strong>Account #:</strong> 6261010783<br>
                                    <strong>SWIFT Code:</strong> ECOCGMGMXXX
                                </small>
                            </div>
                            
                            <!-- WAVE -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="payment_method" value="wave" id="wave">
                                <label class="form-check-label" for="wave">
                                    <strong>1️⃣ WAVE</strong>
                                </label>
                            </div>
                            <div class="ms-4 mb-3 text-muted">
                                <small>
                                    <strong>Phone:</strong> +2205427090<br>
                                    <strong>Name:</strong> Foday Muhammed Jabbi
                                </small>
                            </div>
                            
                            <!-- Western Union -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="payment_method" value="western_union" id="western_union">
                                <label class="form-check-label" for="western_union">
                                    <strong>1️⃣ Western Union</strong>
                                </label>
                            </div>
                            <div class="ms-4 mb-3 text-muted">
                                <small>
                                    <strong>Receiver Name:</strong> Foday Muhammed Jabbi<br>
                                    <strong>Country:</strong> The Gambia<br>
                                    <strong>Phone:</strong> +2205427090
                                </small>
                            </div>
                            
                            <!-- MoneyGram -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="payment_method" value="moneygram" id="moneygram">
                                <label class="form-check-label" for="moneygram">
                                    <strong>2️⃣ MoneyGram</strong>
                                </label>
                            </div>
                            <div class="ms-4 mb-3 text-muted">
                                <small>
                                    <strong>Receiver Name:</strong> Foday Muhammed Jabbi<br>
                                    <strong>Country:</strong> The Gambia<br>
                                    <strong>Phone:</strong> +2205427090
                                </small>
                            </div>
                            
                            <!-- Ria Money Transfer -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="payment_method" value="ria" id="ria">
                                <label class="form-check-label" for="ria">
                                    <strong>3️⃣ Ria Money Transfer</strong>
                                </label>
                            </div>
                            <div class="ms-4 mb-3 text-muted">
                                <small>
                                    <strong>Receiver Name:</strong> Foday Muhammed Jabbi<br>
                                    <strong>Country:</strong> The Gambia<br>
                                    <strong>Phone:</strong> +2205427090
                                </small>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <!-- Customer Information -->
                        <div class="mb-4">
                            <h6><strong>Submit Your Payment Details</strong></h6>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="full_name" class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="full_name" name="full_name" value="{{ current_user.first_name }} {{ current_user.last_name }}" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="phone" class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="email" name="email" value="{{ current_user.email }}" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="address" class="form-label">Address</label>
                                <textarea class="form-control" id="address" name="address" rows="3" required></textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label for="payment_proof" class="form-label">Upload Payment Proof</label>
                                <input type="file" class="form-control" id="payment_proof" name="payment_proof" accept=".jpg,.jpeg,.png,.pdf">
                                <div class="form-text">Upload screenshot or receipt of your payment</div>
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            <strong>Important:</strong> After submitting your order, our team will verify your payment. You will receive access to your courses once payment is confirmed.
                        </div>
                        
                        <button type="submit" class="btn btn-success btn-lg w-100">
                            <i class="fas fa-paper-plane"></i> Submit Order - GMD {{ "%.2f"|format(total) }}
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-shopping-cart"></i> Order Summary</h5>
                </div>
                <div class="card-body">
                    {% for item in cart_items %}
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <h6 class="mb-1">{{ item.course.title }}</h6>
                                <small class="text-muted">{{ item.course.level }} • {{ item.course.duration_weeks }} weeks</small>
                            </div>
                            <span class="fw-bold">GMD {{ "%.2f"|format(item.course.price) }}</span>
                        </div>
                    {% endfor %}
                    <hr>
                    <div class="d-flex justify-content-between">
                        <strong>Total:</strong>
                        <strong class="text-success">GMD {{ "%.2f"|format(total) }}</strong>
                    </div>
                </div>
            </div>
            
            <!-- Payment Instructions -->
            <div class="card mt-3">
                <div class="card-header">
                    <h6><i class="fas fa-info-circle"></i> Payment Instructions</h6>
                </div>
                <div class="card-body">
                    <ol class="small">
                        <li>Select your preferred payment method above</li>
                        <li>Send the exact amount to the provided details</li>
                        <li>Upload your payment proof (screenshot/receipt)</li>
                        <li>Fill in your contact information</li>
                        <li>Submit your order for verification</li>
                        <li>Wait for admin confirmation (usually within 24 hours)</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
